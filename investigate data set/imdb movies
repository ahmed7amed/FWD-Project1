Jupyter Notebook
Investigate_a_Dataset
Last Checkpoint: Last Friday at 1:04 PM
(autosaved)
Current Kernel Logo
Python 3 
File
Edit
View
Insert
Cell
Kernel
Widgets
Help

Markdown
Tip: Welcome to the Investigate a Dataset project! You will find tips in quoted sections like this to help organize your approach to your investigation. Once you complete this project, remove these Tip sections from your report before submission. First things first, you might want to double-click this Markdown cell and change the title so that it reflects your dataset and investigation.

Project: Investigate a Dataset - [TMDb movie data]
Table of Contents
Introduction
Data Wrangling
Exploratory Data Analysis
Conclusions

Introduction
Dataset Description
This data set consists of more than 10,000 movies with information about them extracted from TMDB. The dataset contains movies from 1960 to 2015. Original data source from Kaggle.

Columns Descreption:
id :unique id for each movie on TMDB
imdb_id:imdb id for each movie on TMDB
popularity: an indicator used to measure the popularity of the movie.
budget:the total budget of the movie in USD.
revenue:the total revenue of the movie in USD.
original_title: the original title of the movie.
cast:the names of the cast of the movie separated by "|".
homepage: the website of the movie (if it existed).
director:name(s) of the director(s) of the movie (separated by "|" if there are more than one director).
tagline:a catchphrase describing the movie.
keywords: keywords related to the movie.
overview:summary of the plot of the movie.
runtime:total runtime of the movie in minutes.
genres: genres of the movie separated by "|".
production_companies:production companof the movie.
release_date:release date of the movie.
vote_count:number of voters of te movie.
vote_average:the average user rating of the movie
release_year:release year of the movie
budget_adj:the total budget of the moviein USD in terms of 2010 dollars, accounting for inflation over time.
revenue_adj:the total budget of the movie in USD in terms of 2010 dollars, accounting for inflation over time.
ٍِِAsking Phase :
is there is a relation between popularity and revenue?
is there is a relation between popularity and profit?
is there is a relation between popularity and budget?
is there is a relation between popularity and run time?
is there is a relation between popularity and genres?
does high budget always means high revenue?
what kind of properties associtaed with movies with high revenue?
what is the best 10 movies according to profit,genres,popularity,vote average?
what is the number of movies for each director?
what is best directors according to popularity,profits,vote average?
does runtime have correlaation with profit,vote,popularity?
does genres have coorelation with popularity ?
what is the best movie genres in every year ?
what is profit of genres every year ?
what vote average for genres every year?
what is number of genres all time?
what is the profits from genres all time ?
vote average for genres al time?
what is the No. of movies every year?
what are the total profits every year?
what is the best year for movies production in terms of average rating?
does month realease have effect on profit ?
Prepare Phase :
Now i defined needed questions to answer, we will use ('tmdb-movies.csv') for analysis so first thing to make it readable here and add needed packages.

# Use this cell to set up import statements for all of the packages that you
#   plan to use.
import pandas as pd 
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns 
Process Phase :

Data Wrangling
Now i will load data set here to start working on it ,and showm summary about current shape of dataset

# Load your data and print out a few lines. Perform operations to inspect data
#   types and look for instances of missing or possibly errant data.
df = pd.read_csv('Database_TMDb_movie_data/tmdb-movies.csv')
df.head(3)
id	imdb_id	popularity	budget	revenue	original_title	cast	homepage	director	tagline	...	overview	runtime	genres	production_companies	release_date	vote_count	vote_average	release_year	budget_adj	revenue_adj
0	135397	tt0369610	32.985763	150000000	1513528810	Jurassic World	Chris Pratt|Bryce Dallas Howard|Irrfan Khan|Vi...	http://www.jurassicworld.com/	Colin Trevorrow	The park is open.	...	Twenty-two years after the events of Jurassic ...	124	Action|Adventure|Science Fiction|Thriller	Universal Studios|Amblin Entertainment|Legenda...	6/9/15	5562	6.5	2015	1.379999e+08	1.392446e+09
1	76341	tt1392190	28.419936	150000000	378436354	Mad Max: Fury Road	Tom Hardy|Charlize Theron|Hugh Keays-Byrne|Nic...	http://www.madmaxmovie.com/	George Miller	What a Lovely Day.	...	An apocalyptic story set in the furthest reach...	120	Action|Adventure|Science Fiction|Thriller	Village Roadshow Pictures|Kennedy Miller Produ...	5/13/15	6185	7.1	2015	1.379999e+08	3.481613e+08
2	262500	tt2908446	13.112507	110000000	295238201	Insurgent	Shailene Woodley|Theo James|Kate Winslet|Ansel...	http://www.thedivergentseries.movie/#insurgent	Robert Schwentke	One Choice Can Destroy You	...	Beatrice Prior must confront her inner demons ...	119	Adventure|Science Fiction|Thriller	Summit Entertainment|Mandeville Films|Red Wago...	3/18/15	2480	6.3	2015	1.012000e+08	2.716190e+08
3 rows × 21 columns

df.shape
(10866, 21)
df.info()
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 10866 entries, 0 to 10865
Data columns (total 21 columns):
id                      10866 non-null int64
imdb_id                 10856 non-null object
popularity              10866 non-null float64
budget                  10866 non-null int64
revenue                 10866 non-null int64
original_title          10866 non-null object
cast                    10790 non-null object
homepage                2936 non-null object
director                10822 non-null object
tagline                 8042 non-null object
keywords                9373 non-null object
overview                10862 non-null object
runtime                 10866 non-null int64
genres                  10843 non-null object
production_companies    9836 non-null object
release_date            10866 non-null object
vote_count              10866 non-null int64
vote_average            10866 non-null float64
release_year            10866 non-null int64
budget_adj              10866 non-null float64
revenue_adj             10866 non-null float64
dtypes: float64(4), int64(6), object(11)
memory usage: 1.7+ MB
df.dtypes
id                        int64
imdb_id                  object
popularity              float64
budget                    int64
revenue                   int64
original_title           object
cast                     object
homepage                 object
director                 object
tagline                  object
keywords                 object
overview                 object
runtime                   int64
genres                   object
production_companies     object
release_date             object
vote_count                int64
vote_average            float64
release_year              int64
budget_adj              float64
revenue_adj             float64
dtype: object
df.describe()
id	popularity	budget	revenue	runtime	vote_count	vote_average	release_year	budget_adj	revenue_adj
count	10866.000000	10866.000000	1.086600e+04	1.086600e+04	10866.000000	10866.000000	10866.000000	10866.000000	1.086600e+04	1.086600e+04
mean	66064.177434	0.646441	1.462570e+07	3.982332e+07	102.070863	217.389748	5.974922	2001.322658	1.755104e+07	5.136436e+07
std	92130.136561	1.000185	3.091321e+07	1.170035e+08	31.381405	575.619058	0.935142	12.812941	3.430616e+07	1.446325e+08
min	5.000000	0.000065	0.000000e+00	0.000000e+00	0.000000	10.000000	1.500000	1960.000000	0.000000e+00	0.000000e+00
25%	10596.250000	0.207583	0.000000e+00	0.000000e+00	90.000000	17.000000	5.400000	1995.000000	0.000000e+00	0.000000e+00
50%	20669.000000	0.383856	0.000000e+00	0.000000e+00	99.000000	38.000000	6.000000	2006.000000	0.000000e+00	0.000000e+00
75%	75610.000000	0.713817	1.500000e+07	2.400000e+07	111.000000	145.750000	6.600000	2011.000000	2.085325e+07	3.369710e+07
max	417859.000000	32.985763	4.250000e+08	2.781506e+09	900.000000	9767.000000	9.200000	2015.000000	4.250000e+08	2.827124e+09
df.isnull().sum()
id                         0
imdb_id                   10
popularity                 0
budget                     0
revenue                    0
original_title             0
cast                      76
homepage                7930
director                  44
tagline                 2824
keywords                1493
overview                   4
runtime                    0
genres                    23
production_companies    1030
release_date               0
vote_count                 0
vote_average               0
release_year               0
budget_adj                 0
revenue_adj                0
dtype: int64
df.duplicated().sum()
1
Data Cleaning
After checking data structure , there is some issues need to be solved or modified :

There are some columns we will not need in analyzing, so we can drop them
Release date data type format need to be modified
There are some null values but according to its quantity it could be drop
There are 1 duplicated value can be dropped
i will create two new calculated columns for analysis process plus we will add categorical level for vote averaga and ptofits
genres columns had many values , we will split it and work only on first value
#modifying data types for release date
​
df["release_date"] = pd.to_datetime(df["release_date"])
df.dtypes
id                               int64
imdb_id                         object
popularity                     float64
budget                           int64
revenue                          int64
original_title                  object
cast                            object
homepage                        object
director                        object
tagline                         object
keywords                        object
overview                        object
runtime                          int64
genres                          object
production_companies            object
release_date            datetime64[ns]
vote_count                       int64
vote_average                   float64
release_year                     int64
budget_adj                     float64
revenue_adj                    float64
dtype: object
#creating two new columns based on current columns (release_month&profit)
​
df['release_month']=df['release_date'].dt.month
​
df['profit']=df['revenue']-df['budget']
df['profit_val']=df['profit']
df['vote_val']=df['vote_average']
​
df.head(5)
id	imdb_id	popularity	budget	revenue	original_title	cast	homepage	director	tagline	...	release_date	vote_count	vote_average	release_year	budget_adj	revenue_adj	release_month	profit	profit_val	vote_val
0	135397	tt0369610	32.985763	150000000	1513528810	Jurassic World	Chris Pratt|Bryce Dallas Howard|Irrfan Khan|Vi...	http://www.jurassicworld.com/	Colin Trevorrow	The park is open.	...	2015-06-09	5562	6.5	2015	1.379999e+08	1.392446e+09	6	1363528810	1363528810	6.5
1	76341	tt1392190	28.419936	150000000	378436354	Mad Max: Fury Road	Tom Hardy|Charlize Theron|Hugh Keays-Byrne|Nic...	http://www.madmaxmovie.com/	George Miller	What a Lovely Day.	...	2015-05-13	6185	7.1	2015	1.379999e+08	3.481613e+08	5	228436354	228436354	7.1
2	262500	tt2908446	13.112507	110000000	295238201	Insurgent	Shailene Woodley|Theo James|Kate Winslet|Ansel...	http://www.thedivergentseries.movie/#insurgent	Robert Schwentke	One Choice Can Destroy You	...	2015-03-18	2480	6.3	2015	1.012000e+08	2.716190e+08	3	185238201	185238201	6.3
3	140607	tt2488496	11.173104	200000000	2068178225	Star Wars: The Force Awakens	Harrison Ford|Mark Hamill|Carrie Fisher|Adam D...	http://www.starwars.com/films/star-wars-episod...	J.J. Abrams	Every generation has a story.	...	2015-12-15	5292	7.5	2015	1.839999e+08	1.902723e+09	12	1868178225	1868178225	7.5
4	168259	tt2820852	9.335014	190000000	1506249360	Furious 7	Vin Diesel|Paul Walker|Jason Statham|Michelle ...	http://www.furious7.com/	James Wan	Vengeance Hits Home	...	2015-04-01	2947	7.3	2015	1.747999e+08	1.385749e+09	4	1316249360	1316249360	7.3
5 rows × 25 columns

#we will also conver  profits&Vote_average  to categories ('not_popular', 'below_avg', 'average', 'popular') first we will create function:
def catigorize_col (df, col, labels):
    """
    catigorizes a certain column based on its quartiles
   
    Args:
        (df)     df   - dataframe we are proccesing
        (col)    str  - to be catigorized column's name 
        (labels) list - list of labels from min to max
    
    Returns:
        (df)     df   - dataframe with the categorized col
    """
    
    # setting the edges to cut the column accordingly
    edges = [df[col].describe()['min'],
             df[col].describe()['25%'],
             df[col].describe()['50%'],
             df[col].describe()['75%'],
             df[col].describe()['max']]
    
    df[col] = pd.cut(df[col], edges, labels = labels, duplicates='drop')
    return df
    
    
Converting Vote_average to categorical
# define labels for these edges
labels = ['not_popular', 'below_avg', 'average', 'popular']
catigorize_col(df, 'vote_average', labels)
id	imdb_id	popularity	budget	revenue	original_title	cast	homepage	director	tagline	...	release_date	vote_count	vote_average	release_year	budget_adj	revenue_adj	release_month	profit	profit_val	vote_val
0	135397	tt0369610	32.985763	150000000	1513528810	Jurassic World	Chris Pratt|Bryce Dallas Howard|Irrfan Khan|Vi...	http://www.jurassicworld.com/	Colin Trevorrow	The park is open.	...	2015-06-09	5562	average	2015	1.379999e+08	1.392446e+09	6	1363528810	1363528810	6.5
1	76341	tt1392190	28.419936	150000000	378436354	Mad Max: Fury Road	Tom Hardy|Charlize Theron|Hugh Keays-Byrne|Nic...	http://www.madmaxmovie.com/	George Miller	What a Lovely Day.	...	2015-05-13	6185	popular	2015	1.379999e+08	3.481613e+08	5	228436354	228436354	7.1
2	262500	tt2908446	13.112507	110000000	295238201	Insurgent	Shailene Woodley|Theo James|Kate Winslet|Ansel...	http://www.thedivergentseries.movie/#insurgent	Robert Schwentke	One Choice Can Destroy You	...	2015-03-18	2480	average	2015	1.012000e+08	2.716190e+08	3	185238201	185238201	6.3
3	140607	tt2488496	11.173104	200000000	2068178225	Star Wars: The Force Awakens	Harrison Ford|Mark Hamill|Carrie Fisher|Adam D...	http://www.starwars.com/films/star-wars-episod...	J.J. Abrams	Every generation has a story.	...	2015-12-15	5292	popular	2015	1.839999e+08	1.902723e+09	12	1868178225	1868178225	7.5
4	168259	tt2820852	9.335014	190000000	1506249360	Furious 7	Vin Diesel|Paul Walker|Jason Statham|Michelle ...	http://www.furious7.com/	James Wan	Vengeance Hits Home	...	2015-04-01	2947	popular	2015	1.747999e+08	1.385749e+09	4	1316249360	1316249360	7.3
5	281957	tt1663202	9.110700	135000000	532950503	The Revenant	Leonardo DiCaprio|Tom Hardy|Will Poulter|Domhn...	http://www.foxmovies.com/movies/the-revenant	Alejandro GonzÃ¡lez IÃ±Ã¡rritu	(n. One who has returned, as if from the dead.)	...	2015-12-25	3929	popular	2015	1.241999e+08	4.903142e+08	12	397950503	397950503	7.2
6	87101	tt1340138	8.654359	155000000	440603537	Terminator Genisys	Arnold Schwarzenegger|Jason Clarke|Emilia Clar...	http://www.terminatormovie.com/	Alan Taylor	Reset the future	...	2015-06-23	2598	below_avg	2015	1.425999e+08	4.053551e+08	6	285603537	285603537	5.8
7	286217	tt3659388	7.667400	108000000	595380321	The Martian	Matt Damon|Jessica Chastain|Kristen Wiig|Jeff ...	http://www.foxmovies.com/movies/the-martian	Ridley Scott	Bring Him Home	...	2015-09-30	4572	popular	2015	9.935996e+07	5.477497e+08	9	487380321	487380321	7.6
8	211672	tt2293640	7.404165	74000000	1156730962	Minions	Sandra Bullock|Jon Hamm|Michael Keaton|Allison...	http://www.minionsmovie.com/	Kyle Balda|Pierre Coffin	Before Gru, they had a history of bad bosses	...	2015-06-17	2893	average	2015	6.807997e+07	1.064192e+09	6	1082730962	1082730962	6.5
9	150540	tt2096673	6.326804	175000000	853708609	Inside Out	Amy Poehler|Phyllis Smith|Richard Kind|Bill Ha...	http://movies.disney.com/inside-out	Pete Docter	Meet the little voices inside your head.	...	2015-06-09	3935	popular	2015	1.609999e+08	7.854116e+08	6	678708609	678708609	8.0
10	206647	tt2379713	6.200282	245000000	880674609	Spectre	Daniel Craig|Christoph Waltz|LÃ©a Seydoux|Ralp...	http://www.sonypictures.com/movies/spectre/	Sam Mendes	A Plan No One Escapes	...	2015-10-26	3254	average	2015	2.253999e+08	8.102203e+08	10	635674609	635674609	6.2
11	76757	tt1617661	6.189369	176000003	183987723	Jupiter Ascending	Mila Kunis|Channing Tatum|Sean Bean|Eddie Redm...	http://www.jupiterascending.com	Lana Wachowski|Lilly Wachowski	Expand your universe.	...	2015-02-04	1937	not_popular	2015	1.619199e+08	1.692686e+08	2	7987720	7987720	5.2
12	264660	tt0470752	6.118847	15000000	36869414	Ex Machina	Domhnall Gleeson|Alicia Vikander|Oscar Isaac|S...	http://exmachina-movie.com/	Alex Garland	There is nothing more human than the will to s...	...	2015-01-21	2854	popular	2015	1.379999e+07	3.391985e+07	1	21869414	21869414	7.6
13	257344	tt2120120	5.984995	88000000	243637091	Pixels	Adam Sandler|Michelle Monaghan|Peter Dinklage|...	http://www.pixels-movie.com/	Chris Columbus	Game On.	...	2015-07-16	1575	below_avg	2015	8.095996e+07	2.241460e+08	7	155637091	155637091	5.8
14	99861	tt2395427	5.944927	280000000	1405035767	Avengers: Age of Ultron	Robert Downey Jr.|Chris Hemsworth|Mark Ruffalo...	http://marvel.com/movies/movie/193/avengers_ag...	Joss Whedon	A New Age Has Come.	...	2015-04-22	4304	popular	2015	2.575999e+08	1.292632e+09	4	1125035767	1125035767	7.4
15	273248	tt3460252	5.898400	44000000	155760117	The Hateful Eight	Samuel L. Jackson|Kurt Russell|Jennifer Jason ...	http://thehatefuleight.com/	Quentin Tarantino	No one comes up here without a damn good reason.	...	2015-12-25	2389	popular	2015	4.047998e+07	1.432992e+08	12	111760117	111760117	7.4
16	260346	tt2446042	5.749758	48000000	325771424	Taken 3	Liam Neeson|Forest Whitaker|Maggie Grace|Famke...	http://www.taken3movie.com/	Olivier Megaton	It Ends Here	...	2015-01-01	1578	average	2015	4.415998e+07	2.997096e+08	1	277771424	277771424	6.1
17	102899	tt0478970	5.573184	130000000	518602163	Ant-Man	Paul Rudd|Michael Douglas|Evangeline Lilly|Cor...	http://marvel.com/movies/movie/180/ant-man	Peyton Reed	Heroes Don't Get Any Bigger	...	2015-07-14	3779	popular	2015	1.195999e+08	4.771138e+08	7	388602163	388602163	7.0
18	150689	tt1661199	5.556818	95000000	542351353	Cinderella	Lily James|Cate Blanchett|Richard Madden|Helen...	NaN	Kenneth Branagh	Midnight is just the beginning.	...	2015-03-12	1495	popular	2015	8.739996e+07	4.989630e+08	3	447351353	447351353	6.8
19	131634	tt1951266	5.476958	160000000	650523427	The Hunger Games: Mockingjay - Part 2	Jennifer Lawrence|Josh Hutcherson|Liam Hemswor...	http://www.thehungergames.movie/	Francis Lawrence	The fire will burn forever.	...	2015-11-18	2380	average	2015	1.471999e+08	5.984813e+08	11	490523427	490523427	6.5
20	158852	tt1964418	5.462138	190000000	209035668	Tomorrowland	Britt Robertson|George Clooney|Raffey Cassidy|...	http://movies.disney.com/tomorrowland	Brad Bird	Imagine a world where nothing is impossible.	...	2015-05-19	1899	average	2015	1.747999e+08	1.923127e+08	5	19035668	19035668	6.2
21	307081	tt1798684	5.337064	30000000	91709827	Southpaw	Jake Gyllenhaal|Rachel McAdams|Forest Whitaker...	NaN	Antoine Fuqua	Believe in Hope.	...	2015-06-15	1386	popular	2015	2.759999e+07	8.437300e+07	6	61709827	61709827	7.3
22	254128	tt2126355	4.907832	110000000	470490832	San Andreas	Dwayne Johnson|Alexandra Daddario|Carla Gugino...	http://www.sanandreasmovie.com/	Brad Peyton	A rescue pilot survived an earthquake, this is...	...	2015-05-27	2060	average	2015	1.012000e+08	4.328514e+08	5	360490832	360490832	6.1
23	216015	tt2322441	4.710402	40000000	569651467	Fifty Shades of Grey	Dakota Johnson|Jamie Dornan|Jennifer Ehle|Eloi...	https://www.facebook.com/fiftyshadesofgreymovie	Sam Taylor-Johnson	Are you curious?	...	2015-02-11	1865	not_popular	2015	3.679998e+07	5.240791e+08	2	529651467	529651467	5.3
24	318846	tt1596363	4.648046	28000000	133346506	The Big Short	Christian Bale|Steve Carell|Ryan Gosling|Brad ...	http://www.thebigshortmovie.com/	Adam McKay	This is a true story.	...	2015-12-11	1545	popular	2015	2.575999e+07	1.226787e+08	12	105346506	105346506	7.3
25	177677	tt2381249	4.566713	150000000	682330139	Mission: Impossible - Rogue Nation	Tom Cruise|Jeremy Renner|Simon Pegg|Rebecca Fe...	http://www.missionimpossible.com	Christopher McQuarrie	Desperate Times. Desperate Measures.	...	2015-07-23	2349	popular	2015	1.379999e+08	6.277435e+08	7	532330139	532330139	7.1
26	214756	tt2637276	4.564549	68000000	215863606	Ted 2	Mark Wahlberg|Seth MacFarlane|Amanda Seyfried|...	NaN	Seth MacFarlane	Ted is Coming, Again.	...	2015-06-25	1666	average	2015	6.255997e+07	1.985944e+08	6	147863606	147863606	6.3
27	207703	tt2802144	4.503789	81000000	403802136	Kingsman: The Secret Service	Taron Egerton|Colin Firth|Samuel L. Jackson|Mi...	http://www.kingsmanmovie.com/	Matthew Vaughn	Manners maketh man.	...	2015-01-24	3833	popular	2015	7.451997e+07	3.714978e+08	1	322802136	322802136	7.6
28	314365	tt1895587	4.062293	20000000	88346473	Spotlight	Mark Ruffalo|Michael Keaton|Rachel McAdams|Lie...	http://www.spotlightthefilm.com	Tom McCarthy	Break the story. Break the silence.	...	2015-11-06	1559	popular	2015	1.839999e+07	8.127872e+07	11	68346473	68346473	7.8
29	294254	tt4046784	3.968891	61000000	311256926	Maze Runner: The Scorch Trials	Dylan O'Brien|Kaya Scodelario|Thomas Brodie-Sa...	http://mazerunnermovies.com	Wes Ball	The Maze Was Just the Beginning.	...	2015-09-09	1849	average	2015	5.611998e+07	2.863562e+08	9	250256926	250256926	6.4
...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...	...
10836	38720	tt0061170	0.239435	0	0	Walk Don't Run	Cary Grant|Samantha Eggar|Jim Hutton|John Stan...	NaN	Charles Walters	Run, don't walk to see Walk, Don't Run.	...	2066-01-01	11	below_avg	1966	0.000000e+00	0.000000e+00	1	0	0	5.8
10837	19728	tt0060177	0.291704	0	0	The Blue Max	George Peppard|James Mason|Ursula Andress|Jere...	NaN	John Guillermin	There was no quiet on the Western Front!	...	2066-06-21	12	below_avg	1966	0.000000e+00	0.000000e+00	6	0	0	5.5
10838	22383	tt0060862	0.151845	0	0	The Professionals	Burt Lancaster|Lee Marvin|Robert Ryan|Woody St...	NaN	Richard Brooks	Rough, tough and ready.	...	2066-11-01	21	below_avg	1966	0.000000e+00	0.000000e+00	11	0	0	6.0
10839	13353	tt0060550	0.276133	0	0	It's the Great Pumpkin, Charlie Brown	Christopher Shea|Sally Dryer|Kathy Steinberg|A...	NaN	Bill Melendez	Every year he rises from the pumpkin patch...	...	2066-10-27	49	popular	1966	0.000000e+00	0.000000e+00	10	0	0	7.2
10840	34388	tt0060437	0.102530	0	0	Funeral in Berlin	Michael Caine|Paul Hubschmid|Oskar Homolka|Eva...	NaN	Guy Hamilton	NaN	...	2066-12-22	13	below_avg	1966	0.000000e+00	0.000000e+00	12	0	0	5.7
10841	42701	tt0062262	0.264925	75000	0	The Shooting	Will Hutchins|Millie Perkins|Jack Nicholson|Wa...	NaN	Monte Hellman	Suspenseful desert pursuit in the "High Noon" ...	...	2066-10-23	12	below_avg	1966	5.038511e+05	0.000000e+00	10	-75000	-75000	5.5
10842	36540	tt0061199	0.253437	0	0	Winnie the Pooh and the Honey Tree	Sterling Holloway|Junius Matthews|Sebastian Ca...	NaN	Wolfgang Reitherman	NaN	...	2066-01-01	12	popular	1966	0.000000e+00	0.000000e+00	1	0	0	7.9
10843	29710	tt0060588	0.252399	0	0	Khartoum	Charlton Heston|Laurence Olivier|Richard Johns...	NaN	Basil Dearden|Eliot Elisofon	Where the Nile divides, the great Cinerama adv...	...	2066-06-09	12	below_avg	1966	0.000000e+00	0.000000e+00	6	0	0	5.8
10844	23728	tt0059557	0.236098	0	0	Our Man Flint	James Coburn|Lee J. Cobb|Gila Golan|Edward Mul...	NaN	Daniel Mann	The ORIGINAL man of mystery!	...	2066-01-16	13	below_avg	1966	0.000000e+00	0.000000e+00	1	0	0	5.6
10845	5065	tt0059014	0.230873	0	0	Carry On Cowboy	Sid James|Jim Dale|Angela Douglas|Kenneth Will...	NaN	Gerald Thomas	How the west was lost!	...	2066-03-01	15	below_avg	1966	0.000000e+00	0.000000e+00	3	0	0	5.9
10846	17102	tt0059127	0.212716	0	0	Dracula: Prince of Darkness	Christopher Lee|Barbara Shelley|Andrew Keir|Fr...	NaN	Terence Fisher	DEAD for Ten Years DRACULA, Prince of Darkness...	...	2066-01-09	16	below_avg	1966	0.000000e+00	0.000000e+00	1	0	0	5.7
10847	28763	tt0060548	0.034555	0	0	Island of Terror	Peter Cushing|Edward Judd|Carole Gray|Eddie By...	NaN	Terence Fisher	How could they stop the devouring death...that...	...	2066-06-20	13	not_popular	1966	0.000000e+00	0.000000e+00	6	0	0	5.3
10848	2161	tt0060397	0.207257	5115000	12000000	Fantastic Voyage	Stephen Boyd|Raquel Welch|Edmond O'Brien|Donal...	NaN	Richard Fleischer	A Fantastic and Spectacular Voyage... Through ...	...	2066-08-24	42	popular	1966	3.436265e+07	8.061618e+07	8	6885000	6885000	6.7
10849	28270	tt0060445	0.206537	0	0	Gambit	Michael Caine|Shirley MacLaine|Herbert Lom|Joh...	NaN	Ronald Neame	Shirley MacLaine raises Michael Caine!	...	2066-12-16	14	average	1966	0.000000e+00	0.000000e+00	12	0	0	6.1
10850	26268	tt0060490	0.202473	0	0	Harper	Paul Newman|Lauren Bacall|Julie Harris|Arthur ...	NaN	Jack Smight	Harper takes a case - and the payoff is murder.	...	2066-02-23	14	below_avg	1966	0.000000e+00	0.000000e+00	2	0	0	6.0
10851	15347	tt0060182	0.342791	0	0	Born Free	Virginia McKenna|Bill Travers|Geoffrey Keen|Pe...	NaN	James Hill	From The Pages Of The Beloved Best Seller... A...	...	2066-06-22	15	average	1966	0.000000e+00	0.000000e+00	6	0	0	6.6
10852	37301	tt0060165	0.227220	0	0	A Big Hand for the Little Lady	Henry Fonda|Joanne Woodward|Jason Robards|Paul...	NaN	Fielder Cook	All the action you can take...all the adventur...	...	2066-05-31	11	below_avg	1966	0.000000e+00	0.000000e+00	5	0	0	6.0
10853	15598	tt0060086	0.163592	0	0	Alfie	Michael Caine|Shelley Winters|Millicent Martin...	NaN	Lewis Gilbert	Is any man an Alfie? Ask any girl!	...	2066-03-29	26	average	1966	0.000000e+00	0.000000e+00	3	0	0	6.2
10854	31602	tt0060232	0.146402	0	0	The Chase	Marlon Brando|Jane Fonda|Robert Redford|E.G. M...	NaN	Arthur Penn	The chase is on!	...	2066-02-17	17	below_avg	1966	0.000000e+00	0.000000e+00	2	0	0	6.0
10855	13343	tt0059221	0.141026	700000	0	The Ghost & Mr. Chicken	Don Knotts|Joan Staley|Liam Redmond|Dick Sarge...	NaN	Alan Rafkin	G-G-GUARANTEED! YOU'LL BE SCARED UNTIL YOU LAU...	...	2066-01-20	14	average	1966	4.702610e+06	0.000000e+00	1	-700000	-700000	6.1
10856	20277	tt0061135	0.140934	0	0	The Ugly Dachshund	Dean Jones|Suzanne Pleshette|Charles Ruggles|K...	NaN	Norman Tokar	A HAPPY HONEYMOON GOES TO THE DOGS!...When a G...	...	2066-02-16	14	below_avg	1966	0.000000e+00	0.000000e+00	2	0	0	5.7
10857	5921	tt0060748	0.131378	0	0	Nevada Smith	Steve McQueen|Karl Malden|Brian Keith|Arthur K...	NaN	Henry Hathaway	Some called him savage- and some called him sa...	...	2066-06-10	10	below_avg	1966	0.000000e+00	0.000000e+00	6	0	0	5.9
10858	31918	tt0060921	0.317824	0	0	The Russians Are Coming, The Russians Are Coming	Carl Reiner|Eva Marie Saint|Alan Arkin|Brian K...	NaN	Norman Jewison	IT'S A PLOT! ...to make the world die laughing!!	...	2066-05-25	11	below_avg	1966	0.000000e+00	0.000000e+00	5	0	0	5.5
10859	20620	tt0060955	0.089072	0	0	Seconds	Rock Hudson|Salome Jens|John Randolph|Will Gee...	NaN	John Frankenheimer	NaN	...	2066-10-05	22	average	1966	0.000000e+00	0.000000e+00	10	0	0	6.6
10860	5060	tt0060214	0.087034	0	0	Carry On Screaming!	Kenneth Williams|Jim Dale|Harry H. Corbett|Joa...	NaN	Gerald Thomas	Carry On Screaming with the Hilarious CARRY ON...	...	2066-05-20	13	popular	1966	0.000000e+00	0.000000e+00	5	0	0	7.0
10861	21	tt0060371	0.080598	0	0	The Endless Summer	Michael Hynson|Robert August|Lord 'Tally Ho' B...	NaN	Bruce Brown	NaN	...	2066-06-15	11	popular	1966	0.000000e+00	0.000000e+00	6	0	0	7.4
10862	20379	tt0060472	0.065543	0	0	Grand Prix	James Garner|Eva Marie Saint|Yves Montand|Tosh...	NaN	John Frankenheimer	Cinerama sweeps YOU into a drama of speed and ...	...	2066-12-21	20	below_avg	1966	0.000000e+00	0.000000e+00	12	0	0	5.7
10863	39768	tt0060161	0.065141	0	0	Beregis Avtomobilya	Innokentiy Smoktunovskiy|Oleg Efremov|Georgi Z...	NaN	Eldar Ryazanov	NaN	...	2066-01-01	11	average	1966	0.000000e+00	0.000000e+00	1	0	0	6.5
10864	21449	tt0061177	0.064317	0	0	What's Up, Tiger Lily?	Tatsuya Mihashi|Akiko Wakabayashi|Mie Hama|Joh...	NaN	Woody Allen	WOODY ALLEN STRIKES BACK!	...	2066-11-02	22	not_popular	1966	0.000000e+00	0.000000e+00	11	0	0	5.4
10865	22293	tt0060666	0.035919	19000	0	Manos: The Hands of Fate	Harold P. Warren|Tom Neyman|John Reynolds|Dian...	NaN	Harold P. Warren	It's Shocking! It's Beyond Your Imagination!	...	2066-11-15	15	NaN	1966	1.276423e+05	0.000000e+00	11	-19000	-19000	1.5
10866 rows × 25 columns

Converting profit into a categorical variable
# define labels for these edges
labels = ['low', 'average', 'high']
catigorize_col(df, 'profit', labels)
df.head(5)
id	imdb_id	popularity	budget	revenue	original_title	cast	homepage	director	tagline	...	release_date	vote_count	vote_average	release_year	budget_adj	revenue_adj	release_month	profit	profit_val	vote_val
0	135397	tt0369610	32.985763	150000000	1513528810	Jurassic World	Chris Pratt|Bryce Dallas Howard|Irrfan Khan|Vi...	http://www.jurassicworld.com/	Colin Trevorrow	The park is open.	...	2015-06-09	5562	average	2015	1.379999e+08	1.392446e+09	6	high	1363528810	6.5
1	76341	tt1392190	28.419936	150000000	378436354	Mad Max: Fury Road	Tom Hardy|Charlize Theron|Hugh Keays-Byrne|Nic...	http://www.madmaxmovie.com/	George Miller	What a Lovely Day.	...	2015-05-13	6185	popular	2015	1.379999e+08	3.481613e+08	5	high	228436354	7.1
2	262500	tt2908446	13.112507	110000000	295238201	Insurgent	Shailene Woodley|Theo James|Kate Winslet|Ansel...	http://www.thedivergentseries.movie/#insurgent	Robert Schwentke	One Choice Can Destroy You	...	2015-03-18	2480	average	2015	1.012000e+08	2.716190e+08	3	high	185238201	6.3
3	140607	tt2488496	11.173104	200000000	2068178225	Star Wars: The Force Awakens	Harrison Ford|Mark Hamill|Carrie Fisher|Adam D...	http://www.starwars.com/films/star-wars-episod...	J.J. Abrams	Every generation has a story.	...	2015-12-15	5292	popular	2015	1.839999e+08	1.902723e+09	12	high	1868178225	7.5
4	168259	tt2820852	9.335014	190000000	1506249360	Furious 7	Vin Diesel|Paul Walker|Jason Statham|Michelle ...	http://www.furious7.com/	James Wan	Vengeance Hits Home	...	2015-04-01	2947	popular	2015	1.747999e+08	1.385749e+09	4	high	1316249360	7.3
5 rows × 25 columns

#dropping columns (noise source) which i will not need 
​
#first define columns name
​
df.columns
Index(['id', 'imdb_id', 'popularity', 'budget', 'revenue', 'original_title',
       'cast', 'homepage', 'director', 'tagline', 'keywords', 'overview',
       'runtime', 'genres', 'production_companies', 'release_date',
       'vote_count', 'vote_average', 'release_year', 'budget_adj',
       'revenue_adj', 'release_month', 'profit', 'profit_val', 'vote_val'],
      dtype='object')
#drop not needed columns
df.drop(columns=['id', 'imdb_id', 'homepage', 'cast','tagline', 'keywords', 'overview','production_companies', 'release_date',
         'budget_adj','revenue_adj'],axis=1,inplace=True)
#checking data structure
df.head(2)
popularity	budget	revenue	original_title	director	runtime	genres	vote_count	vote_average	release_year	release_month	profit	profit_val	vote_val
0	32.985763	150000000	1513528810	Jurassic World	Colin Trevorrow	124	Action|Adventure|Science Fiction|Thriller	5562	average	2015	6	high	1363528810	6.5
1	28.419936	150000000	378436354	Mad Max: Fury Road	George Miller	120	Action|Adventure|Science Fiction|Thriller	6185	popular	2015	5	high	228436354	7.1
# drop null values 
df.dropna(inplace=True)
​
# confirm no null values 
df.isnull().sum()
popularity        0
budget            0
revenue           0
original_title    0
director          0
runtime           0
genres            0
vote_count        0
vote_average      0
release_year      0
release_month     0
profit            0
profit_val        0
vote_val          0
dtype: int64
# drop duplicated values 
df.drop_duplicates(inplace=True)
​
# confirm no duplicated values 
df.duplicated().sum()
0
df.shape
(10797, 14)
#checking Zero Values in Data frame
df.isin([0]).sum()
popularity           0
budget            5635
revenue           5950
original_title       0
director             0
runtime             28
genres               0
vote_count           0
vote_average         0
release_year         0
release_month        0
profit               0
profit_val        4644
vote_val             0
dtype: int64
#zero values are big compared to dataframe size so we cant remove but we will replace zero with mean value for each column
df['budget'].replace(to_replace = 0, value = df['budget'].mean(), inplace=True)
df['revenue'].replace(to_replace = 0, value = df['revenue'].mean(), inplace=True)
df['profit_val'].replace(to_replace = 0, value = df['profit_val'].mean(), inplace=True)
​
df.isin([0]).sum()
popularity         0
budget             0
revenue            0
original_title     0
director           0
runtime           28
genres             0
vote_count         0
vote_average       0
release_year       0
release_month      0
profit             0
profit_val         0
vote_val           0
dtype: int64
#splitting 'genres' column and using only first value 
df['genres']=df['genres'].apply(lambda x:x.split("|")[0])
​
#checking data structure
df.head(10)
popularity	budget	revenue	original_title	director	runtime	genres	vote_count	vote_average	release_year	release_month	profit	profit_val	vote_val
0	32.985763	150000000.0	1.513529e+09	Jurassic World	Colin Trevorrow	124	Action	5562	average	2015	6	high	1.363529e+09	6.5
1	28.419936	150000000.0	3.784364e+08	Mad Max: Fury Road	George Miller	120	Action	6185	popular	2015	5	high	2.284364e+08	7.1
2	13.112507	110000000.0	2.952382e+08	Insurgent	Robert Schwentke	119	Adventure	2480	average	2015	3	high	1.852382e+08	6.3
3	11.173104	200000000.0	2.068178e+09	Star Wars: The Force Awakens	J.J. Abrams	136	Action	5292	popular	2015	12	high	1.868178e+09	7.5
4	9.335014	190000000.0	1.506249e+09	Furious 7	James Wan	137	Action	2947	popular	2015	4	high	1.316249e+09	7.3
5	9.110700	135000000.0	5.329505e+08	The Revenant	Alejandro GonzÃ¡lez IÃ±Ã¡rritu	156	Western	3929	popular	2015	12	high	3.979505e+08	7.2
6	8.654359	155000000.0	4.406035e+08	Terminator Genisys	Alan Taylor	125	Science Fiction	2598	below_avg	2015	6	high	2.856035e+08	5.8
7	7.667400	108000000.0	5.953803e+08	The Martian	Ridley Scott	141	Drama	4572	popular	2015	9	high	4.873803e+08	7.6
8	7.404165	74000000.0	1.156731e+09	Minions	Kyle Balda|Pierre Coffin	91	Family	2893	average	2015	6	high	1.082731e+09	6.5
9	6.326804	175000000.0	8.537086e+08	Inside Out	Pete Docter	94	Comedy	3935	popular	2015	6	high	6.787086e+08	8.0
Now Data cleaning completed and data is ready for analysis to answer questions
Analyzing Phase :

Exploratory Data Analysis
Lets see First Single variables in charts form
Profits&vote average categorical
# box plot to describe how is movie rating is distributed
plt.boxplot(df['vote_val'])
plt.xlabel('vote_Average')
plt.ylabel('rate')
Text(0,0.5,'rate')

# Histogram to define Categorigal distribution for Vote average 
df['vote_average'].hist()
plt.xlabel('vote Category')
plt.ylabel('count')
Text(0,0.5,'count')

## Histogram to define Categorigal distribution for profits
df['profit'].hist()
plt.xlabel('profit Category')
plt.ylabel('count')
Text(0,0.5,'count')

Now we will start to answer questions we mentioned in the beginning
Research Question 1 (is there is a coorelation between popularity and revenue?)
#we will plot scatter plot to discover the answer
df.plot(x='popularity',y='revenue',kind='scatter')
sns.regplot(data=df,x='popularity',y='revenue',line_kws={"color": "red"})
​
<matplotlib.axes._subplots.AxesSubplot at 0x7fd868bc8b38>

It Seems that there is positive coorelation between popularity and revenue although there is some flauctuated outliers

Research Question 2 ( is there is a coorelation between popularity and profit?)
#we will plot scatter plot to discover the answer
df.plot(x='popularity',y='profit_val',kind='scatter')
sns.regplot(data=df,x='popularity',y='profit_val',line_kws={"color": "red"})
plt.title("profits VS Popularity")
​
Text(0.5,1,'profits VS Popularity')

It Seems that there is strong positive coorelation between popularity and profit although there is some flauctuated outliers

Research Question 3 ( is there is a coorelation between popularity and budget ?)
#we will plot scatter plot to discover the answer
df.plot(x='popularity',y='budget',kind='scatter')
sns.regplot(data=df,x='popularity',y='budget',line_kws={"color": "red"})
plt.title("Budget VS Popularity")
​
​
Text(0.5,1,'Budget VS Popularity')

It Seems that there is strong positive coorelation between popularity and budget although there is some flauctuated outliers

Research Question 4 ( does high budget always means high revenue?)
#we will plot scatter plot to discover the answer
plt.scatter(data=df,x='budget',y='revenue')
​
sns.regplot(data=df,x='budget',y='revenue',line_kws={"color": "red"})
plt.title("Budget VS Revenue")
plt.show()
#df.plot(x='budget',y='revenue',kind='scatter')

It Seems that there is strong positive coorelation between revenue and budget although there is some flauctuated outliers

Research Question 5 ( Are the best 10 movies according to profit,popularity,vote average are different or similar?)
#rank for 10 movies According to profit
​
top10_mov=df[['original_title','profit_val']].sort_values("profit_val",ascending=False).head(10)
top10_mov
original_title	profit_val
1386	Avatar	2.544506e+09
3	Star Wars: The Force Awakens	1.868178e+09
5231	Titanic	1.645034e+09
0	Jurassic World	1.363529e+09
4	Furious 7	1.316249e+09
4361	The Avengers	1.299558e+09
3374	Harry Potter and the Deathly Hallows: Part 2	1.202818e+09
14	Avengers: Age of Ultron	1.125036e+09
5422	Frozen	1.124219e+09
8094	The Net	1.084280e+09
top10_mov.plot(x='original_title',y='profit_val',kind="bar")
plt.title("The most 10 movies in profit", fontsize=(10))
plt.xlabel("original_title", fontsize=10)
plt.ylabel("Profit value",fontsize=10)
Text(0,0.5,'Profit value')

#rank for 10 movies According to popularity
​
top10_pop=df[['original_title','popularity']].sort_values("popularity",ascending=False).head(10)
top10_pop
original_title	popularity
0	Jurassic World	32.985763
1	Mad Max: Fury Road	28.419936
629	Interstellar	24.949134
630	Guardians of the Galaxy	14.311205
2	Insurgent	13.112507
631	Captain America: The Winter Soldier	12.971027
1329	Star Wars	12.037933
632	John Wick	11.422751
3	Star Wars: The Force Awakens	11.173104
633	The Hunger Games: Mockingjay - Part 1	10.739009
top10_pop.plot(x='original_title',y='popularity',kind="bar")
plt.title("The most 10 movies in popularity", fontsize=(10))
plt.xlabel("original_title", fontsize=10)
plt.ylabel("popularity",fontsize=10)
Text(0,0.5,'popularity')

#rank for 10 movies According to vote_Average
​
top10_vote=df[['original_title','vote_val']].sort_values("vote_val",ascending=False).head(10)
top10_vote
original_title	vote_val
3894	The Story of Film: An Odyssey	9.2
538	The Mask You Live In	8.9
1200	Black Mirror: White Christmas	8.8
2269	Life Cycles	8.8
6911	Pink Floyd: Pulse	8.7
3690	The Art of Flight	8.5
8221	A Personal Journey with Martin Scorsese Throug...	8.5
8839	Dave Chappelle: Killin' Them Softly	8.5
8411	Queen - Rock Montreal	8.5
2334	Rush: Beyond the Lighted Stage	8.4
top10_vote.plot(x='original_title',y='vote_val',kind="bar")
plt.title("The most 10 movies in voting_Average", fontsize=(10))
plt.xlabel("original_title", fontsize=10)
plt.ylabel("vote_Average",fontsize=10)
Text(0,0.5,'vote_Average')

with looking at above analysis we could find that most positive voted movies is not considered the best movies in terms of popularity or profits more details in conlusion

Research Question 6 ( Are best 5 directors according to popularity,profits,vote average must have highest number of movies?)
# claculating first number of movies for each director 
df['director'].value_counts().sort_values(ascending=False).head(5)
Woody Allen         45
Clint Eastwood      34
Martin Scorsese     29
Steven Spielberg    29
Ridley Scott        23
Name: director, dtype: int64
#rank according to popularity
df.groupby('director')['popularity'].mean().sort_values(ascending=False).head(5)
director
Colin Trevorrow                16.696886
Joe Russo|Anthony Russo        12.971027
Chad Stahelski|David Leitch    11.422751
Don Hall|Chris Williams         8.691294
Juno John Lee                   8.411577
Name: popularity, dtype: float64
#rank according to profits
df.groupby('director')['profit_val'].sum().sort_values(ascending=False).head(5)
director
Steven Spielberg    7.428614e+09
Peter Jackson       5.196469e+09
James Cameron       5.081849e+09
Michael Bay         3.557208e+09
David Yates         3.404695e+09
Name: profit_val, dtype: float64
#rank according to vote average
df.groupby('director')['vote_val'].mean().sort_values(ascending=False).head(5)
director
Mark Cousins                            9.2
Derek Frankowski                        8.8
David Mallet                            8.7
Curt Morgan                             8.5
Martin Scorsese|Michael Henry Wilson    8.5
Name: vote_val, dtype: float64
I cant find special relation between values of profits,popularities,voting or number of movies

Research Question 7 ( does runtime have coorelation with profit,vote,popularity?)
#we will plot scatter plot to discover the answer
df.plot(x='vote_val',y='runtime',kind='scatter')
sns.regplot(data=df,x='vote_val',y='runtime',line_kws={"color": "red"})
plt.title("run time VS vote average")
​
df.plot(x='profit_val',y='runtime',kind='scatter')
sns.regplot(data=df,x='profit_val',y='runtime',line_kws={"color": "red"})
plt.title("run time VS profit")
​
df.plot(x='popularity',y='runtime',kind='scatter')
sns.regplot(data=df,x='popularity',y='runtime',line_kws={"color": "red"})
plt.title("run time VS popularity")
​
​
​
​
Text(0.5,1,'run time VS popularity')



It seems that the relation of runtime with indicators is very week coorelation

Research Question 8 (what is profit of genres every year and what is most profit genres in all time?)
df[['release_year','genres','profit_val']].groupby(['genres','release_year'])['profit_val'].sum().sort_values(ascending=False)
​
genres           release_year
Action           2015            9.015898e+09
                 2014            5.203500e+09
                 2013            4.857891e+09
                 2009            4.496732e+09
                 2012            4.427251e+09
                 2011            4.208951e+09
Drama            2012            4.105108e+09
Comedy           2008            3.918039e+09
                 2009            3.895525e+09
Drama            2015            3.811403e+09
Animation        2013            3.585418e+09
Action           2010            3.553592e+09
Adventure        2011            3.428560e+09
Comedy           2007            3.404875e+09
Drama            2008            3.403219e+09
Comedy           2013            3.148808e+09
                 2014            3.128299e+09
Drama            2010            3.106596e+09
Comedy           2011            3.067920e+09
                 2012            3.056148e+09
Adventure        2003            2.986780e+09
Comedy           2010            2.961364e+09
Adventure        2005            2.925656e+09
Drama            2014            2.916408e+09
Comedy           2015            2.901987e+09
Adventure        2010            2.860767e+09
                 2014            2.854744e+09
                 2012            2.832095e+09
Comedy           2006            2.811927e+09
                 2005            2.773280e+09
                                     ...     
Animation        1985           -3.711308e+06
Mystery          1979           -4.000000e+06
Documentary      1992           -4.000000e+06
Romance          1968           -4.300000e+06
Thriller         1981           -4.850000e+06
History          1995           -4.918413e+06
Western          1999           -5.000000e+06
                 2013           -5.962610e+06
Music            1988           -6.083697e+06
Romance          1984           -8.000000e+06
Western          1993           -8.000000e+06
History          2013           -9.345708e+06
                 2000           -9.600178e+06
TV Movie         2002           -1.000000e+07
War              1990           -1.000000e+07
Science Fiction  1999           -1.100000e+07
Fantasy          1981           -1.200000e+07
History          1975           -1.500000e+07
Mystery          1985           -1.500000e+07
War              2002           -1.611736e+07
Western          2006           -1.680369e+07
Thriller         1996           -1.750000e+07
War              1995           -2.000000e+07
                 2012           -2.019322e+07
History          1993           -3.300000e+07
Music            2001           -4.000810e+07
War              2006           -5.018484e+07
                 2010           -1.200100e+08
Science Fiction  2000           -1.278290e+08
Western          2004           -1.701251e+08
Name: profit_val, Length: 828, dtype: float64
gen_profit=df[['release_year','genres','profit_val']].groupby('genres')['profit_val'].sum().sort_values(ascending=False)
gen_profit
genres
Action             7.072764e+10
Comedy             6.963998e+10
Drama              6.179185e+10
Adventure          5.459225e+10
Animation          2.620617e+10
Horror             2.078291e+10
Fantasy            1.464368e+10
Science Fiction    1.388232e+10
Thriller           1.273547e+10
Crime              1.069099e+10
Documentary        8.692588e+09
Family             8.324750e+09
Romance            7.109979e+09
Mystery            3.153580e+09
Music              2.522407e+09
War                2.123337e+09
TV Movie           1.775088e+09
History            1.707945e+09
Western            8.671033e+08
Foreign            2.285984e+08
Name: profit_val, dtype: float64
gen_profit.plot(x='genres',y='profit_val',kind="bar")
plt.title("The Rank of genres in profits", fontsize=(10))
plt.xlabel("original_title", fontsize=10)
plt.ylabel("Total Profit",fontsize=10)
Text(0,0.5,'Total Profit')

It seems that Action,Adventure,Drama,Comedy Movies are most profit genres from 1960 to 2015

Research Question 9 (what are the total profits every year?)
year_profit=df[['release_year','profit_val']].groupby('release_year')['profit_val'].sum().sort_values(ascending=False).head(10)
year_profit
release_year
2015    2.825904e+10
2014    2.646564e+10
2012    2.368409e+10
2013    2.352434e+10
2011    2.024000e+10
2009    2.001549e+10
2010    1.809791e+10
2008    1.710457e+10
2007    1.639887e+10
2006    1.303353e+10
Name: profit_val, dtype: float64
year_profit.plot(x='genres',y='profit_val',kind="bar")
plt.title("The Rank of years in profits", fontsize=(10))
plt.xlabel("year", fontsize=10)
plt.ylabel("Total Profit",fontsize=10)
Text(0,0.5,'Total Profit')

the total profit ranking is normal as there is increase yearly in population there was only small fluctation some years like 2012 was most profit than 2013,All top 10 years in profit in 20th century.

Research Question 10 (what are genres which is popular every year and all time?
df1=df[['release_year','genres','popularity']].groupby(['release_year','genres'])['popularity'].mean()
df1
release_year  genres         
1960          Action             0.590724
              Adventure          0.304992
              Comedy             0.392067
              Crime              0.269428
              Drama              0.687575
              Horror             0.254964
              Thriller           0.456165
1961          Action             0.540904
              Adventure          1.394596
              Comedy             0.431700
              Drama              0.361247
              Fantasy            0.154073
              Horror             0.254578
              Music              0.900245
              Romance            0.027527
              Science Fiction    0.083697
              Western            0.210021
1962          Action             0.299207
              Adventure          1.283631
              Comedy             0.181376
              Crime              0.472816
              Drama              0.341549
              Fantasy            0.235542
              Horror             0.165468
              Mystery            0.630948
              Thriller           0.153654
              Western            0.516593
1963          Action             1.008599
              Adventure          0.362011
              Animation          2.180410
                                   ...   
2014          Fantasy            1.534768
              History            1.495091
              Horror             0.547167
              Music              0.517015
              Mystery            1.102109
              Romance            0.501257
              Science Fiction    2.168095
              TV Movie           0.267173
              Thriller           0.698125
              War                1.273797
              Western            0.760452
2015          Action             2.881386
              Adventure          2.149264
              Animation          0.606748
              Comedy             0.944319
              Crime              1.824494
              Documentary        0.177013
              Drama              0.760773
              Family             1.297487
              Fantasy            1.270643
              History            0.879763
              Horror             0.474315
              Music              0.386850
              Mystery            0.989721
              Romance            0.856222
              Science Fiction    1.351656
              TV Movie           0.323106
              Thriller           0.628346
              War                2.131503
              Western            4.929120
Name: popularity, Length: 828, dtype: float64
df2=df1.loc[df1.groupby(level=0).idxmax()]
df2
release_year  genres         
1960          Drama              0.687575
1961          Adventure          1.394596
1962          Adventure          1.283631
1963          Animation          2.180410
1964          Adventure          0.736431
1965          Adventure          1.121328
1966          Animation          0.740509
1967          Family             2.550704
1968          Science Fiction    2.088194
1969          History            1.357317
1970          Animation          1.936962
1971          Family             2.430667
1972          Drama              1.495163
1973          Adventure          1.549139
1974          Romance            0.738153
1975          Drama              1.044668
1976          Crime              2.582657
1977          Adventure          3.762110
1978          Music              1.697618
1979          Horror             1.021005
1980          Music              1.607219
1981          Adventure          1.225432
1982          Science Fiction    1.685049
1983          Adventure          1.666077
1984          Fantasy            1.115827
1985          Adventure          1.056025
1986          Adventure          0.790314
1987          Science Fiction    1.960956
1988          Fantasy            0.952525
1989          Animation          1.685298
1990          Romance            0.922730
1991          Romance            3.852269
1992          Animation          1.535277
1993          Adventure          0.996117
1994          Family             1.963754
1995          Science Fiction    1.916606
1996          Science Fiction    1.323991
1997          Animation          1.326255
1998          Science Fiction    1.260368
1999          Mystery            2.578731
2000          Mystery            1.092093
2001          Thriller           1.717315
2002          Adventure          1.911371
2003          Adventure          2.210150
2004          Science Fiction    2.050361
2005          Adventure          1.377486
2006          Music              1.340167
2007          Western            1.150389
2008          Adventure          1.085703
2009          Romance            1.267520
2010          Adventure          1.676019
2011          Adventure          1.216805
2012          Fantasy            1.374851
2013          Science Fiction    1.658902
2014          Adventure          2.363833
2015          Western            4.929120
Name: popularity, dtype: float64
df3=df2.groupby('genres').count()
df3
genres
Adventure          18
Animation           6
Crime               1
Drama               3
Family              3
Fantasy             3
History             1
Horror              1
Music               3
Mystery             2
Romance             4
Science Fiction     8
Thriller            1
Western             2
Name: popularity, dtype: int64
plt.figure(figsize=(8,5))
df3.plot(kind="bar")
plt.title("The most popluar genres", fontsize=(10))
plt.xlabel("genres", fontsize=10)
plt.ylabel("Count",fontsize=10)
plt.show()
​

looking at most popular movie every year we can find that adventure Movies are most popular all time

Research Question 11 (what are genres which is most voted average every year?
df1=df[['release_year','genres','vote_val']].groupby(['release_year','genres'])['vote_val'].mean()
df1
release_year  genres         
1960          Action             6.050000
              Adventure          6.450000
              Comedy             6.271429
              Crime              5.200000
              Drama              6.780000
              Horror             6.416667
              Thriller           6.533333
1961          Action             6.633333
              Adventure          6.300000
              Comedy             6.562500
              Drama              6.442857
              Fantasy            4.950000
              Horror             6.633333
              Music              6.600000
              Romance            6.300000
              Science Fiction    7.200000
              Western            5.866667
1962          Action             6.140000
              Adventure          6.300000
              Comedy             5.500000
              Crime              6.533333
              Drama              6.527273
              Fantasy            6.500000
              Horror             5.900000
              Mystery            7.000000
              Thriller           6.200000
              Western            6.600000
1963          Action             6.433333
              Adventure          6.420000
              Animation          6.700000
                                   ...   
2014          Fantasy            5.525000
              History            6.750000
              Horror             5.094828
              Music              6.300000
              Mystery            5.660000
              Romance            6.073333
              Science Fiction    6.268750
              TV Movie           5.600000
              Thriller           5.274419
              War                6.181818
              Western            5.900000
2015          Action             5.842373
              Adventure          6.350000
              Animation          6.576923
              Comedy             6.055263
              Crime              5.777273
              Documentary        7.038095
              Drama              6.067361
              Family             5.945455
              Fantasy            5.800000
              History            6.671429
              Horror             4.917460
              Music              6.540000
              Mystery            5.600000
              Romance            6.003571
              Science Fiction    5.409524
              TV Movie           5.683333
              Thriller           5.297222
              War                5.700000
              Western            6.400000
Name: vote_val, Length: 828, dtype: float64
df2=df1.loc[df1.groupby(level=0).idxmax()]
df2
release_year  genres         
1960          Drama              6.780000
1961          Science Fiction    7.200000
1962          Mystery            7.000000
1963          Animation          6.700000
1964          Thriller           6.600000
1965          Animation          7.600000
1966          Animation          7.500000
1967          Crime              7.240000
1968          Romance            7.000000
1969          History            7.000000
1970          Mystery            7.500000
1971          Family             7.200000
1972          Music              7.400000
1973          Western            7.250000
1974          Drama              6.711111
1975          Crime              7.200000
1976          Crime              7.800000
1977          Family             7.100000
1978          Music              7.000000
1979          Drama              6.600000
1980          Music              7.300000
1981          Music              8.500000
1982          Animation          7.450000
1983          Family             7.400000
1984          Documentary        7.350000
1985          Documentary        8.300000
1986          Animation          7.300000
1987          TV Movie           7.200000
1988          Mystery            8.000000
1989          Documentary        7.650000
1990          Documentary        7.600000
1991          Romance            7.300000
1992          Documentary        7.600000
1993          Animation          6.600000
1994          Documentary        7.200000
1995          Documentary        8.500000
1996          Music              7.400000
1997          Animation          6.916667
1998          History            6.700000
1999          Mystery            7.500000
2000          Documentary        7.066667
2001          Documentary        6.940000
2002          Western            7.100000
2003          Music              7.000000
2004          Documentary        6.836364
2005          Music              7.600000
2006          Music              6.900000
2007          Music              7.050000
2008          War                7.050000
2009          Documentary        7.009091
2010          History            7.700000
2011          Foreign            7.600000
2012          Music              7.012500
2013          Documentary        6.828070
2014          Documentary        7.035088
2015          Documentary        7.038095
Name: vote_val, dtype: float64
df2.groupby('genres').count()
genres
Animation           7
Crime               3
Documentary        14
Drama               3
Family              3
Foreign             1
History             3
Music              10
Mystery             4
Romance             2
Science Fiction     1
TV Movie            1
Thriller            1
War                 1
Western             2
Name: vote_val, dtype: int64
looking at most voted movie every year we can find that Documentary Movies are highest vote_average all time

Research Question 12 (what are genres which is most profit every year?
df1=df[['release_year','genres','profit_val']].groupby(['release_year','genres'])['profit_val'].sum()
df1
release_year  genres         
1960          Action             2.033039e+08
              Adventure          5.079964e+07
              Comedy             9.286964e+07
              Crime              2.539982e+07
              Drama              1.327923e+08
              Horror             1.011293e+08
              Thriller           5.004964e+07
1961          Action             7.369964e+07
              Adventure          2.372798e+08
              Comedy             1.370991e+08
              Drama              8.664582e+07
              Fantasy            5.079964e+07
              Horror             5.259964e+07
              Music              3.765682e+07
              Romance           -1.500000e+06
              Science Fiction    2.539982e+07
              Western            4.909964e+07
1962          Action             9.159929e+07
              Adventure          1.642996e+08
              Comedy             3.339982e+07
              Crime              6.192949e+07
              Drama              1.531189e+08
              Fantasy           -1.260000e+02
              Horror            -9.200000e+04
              Mystery           -2.200000e+06
              Thriller           2.539982e+07
              Western            3.980000e+07
1963          Action             9.479859e+07
              Adventure          4.979964e+07
              Animation          2.539982e+07
                                     ...     
2014          Fantasy            1.306878e+09
              History            3.337708e+08
              Horror             1.486214e+09
              Music              1.564061e+08
              Mystery            4.701569e+08
              Romance            8.584435e+08
              Science Fiction    1.862189e+09
              TV Movie           1.523989e+08
              Thriller           1.737868e+09
              War                8.831281e+08
              Western            3.722963e+07
2015          Action             9.015898e+09
              Adventure          1.170434e+09
              Animation          6.212023e+08
              Comedy             2.901987e+09
              Crime              9.643138e+08
              Documentary        9.002407e+08
              Drama              3.811403e+09
              Family             1.564824e+09
              Fantasy            4.524996e+08
              History            9.223652e+07
              Horror             1.606307e+09
              Music              2.422018e+08
              Mystery            2.544016e+08
              Romance            1.065005e+09
              Science Fiction    1.059133e+09
              TV Movie           1.523989e+08
              Thriller           1.456279e+09
              War                5.413231e+08
              Western            3.869505e+08
Name: profit_val, Length: 828, dtype: float64
df2=df1.loc[df1.groupby(level=0).idxmax()]
df2
release_year  genres         
1960          Action             2.033039e+08
1961          Adventure          2.372798e+08
1962          Adventure          1.642996e+08
1963          Drama              1.790339e+08
1964          Comedy             2.580404e+08
1965          Drama              4.222349e+08
1966          Action             2.077456e+08
1967          Comedy             3.294155e+08
1968          Drama              1.727900e+08
1969          Drama              1.811842e+08
1970          Drama              2.566996e+08
1971          Drama              2.601248e+08
1972          Drama              3.279884e+08
1973          Drama              6.464051e+08
1974          Action             3.692659e+08
1975          Horror             5.396745e+08
1976          Drama              5.067241e+08
1977          Adventure          9.582365e+08
1978          Horror             4.635695e+08
1979          Drama              7.421362e+08
1980          Adventure          6.155705e+08
1981          Adventure          6.972316e+08
1982          Science Fiction    9.660664e+08
1983          Adventure          8.210696e+08
1984          Action             6.012480e+08
1985          Drama              7.625484e+08
1986          Drama              1.007231e+09
1987          Comedy             1.029322e+09
1988          Comedy             1.294765e+09
1989          Comedy             1.327942e+09
1990          Comedy             1.042084e+09
1991          Action             1.100248e+09
1992          Comedy             1.337860e+09
1993          Drama              1.679634e+09
1994          Comedy             1.583672e+09
1995          Crime              1.387339e+09
1996          Action             2.246260e+09
1997          Drama              2.351658e+09
1998          Comedy             1.570694e+09
1999          Comedy             1.429578e+09
2000          Comedy             1.982632e+09
2001          Adventure          2.725085e+09
2002          Adventure          2.606021e+09
2003          Adventure          2.986780e+09
2004          Drama              2.511170e+09
2005          Adventure          2.925656e+09
2006          Comedy             2.811927e+09
2007          Comedy             3.404875e+09
2008          Comedy             3.918039e+09
2009          Action             4.496732e+09
2010          Action             3.553592e+09
2011          Action             4.208951e+09
2012          Action             4.427251e+09
2013          Action             4.857891e+09
2014          Action             5.203500e+09
2015          Action             9.015898e+09
Name: profit_val, dtype: float64
df2.groupby('genres').sum().sort_values(ascending=False)
genres
Action             4.049189e+10
Comedy             2.332085e+10
Adventure          1.473723e+10
Drama              1.200756e+10
Crime              1.387339e+09
Horror             1.003244e+09
Science Fiction    9.660664e+08
Name: profit_val, dtype: float64
According to profits Action Movies in first place followed by Adventure and Comedy Movies

Research Question 13 (does month realese have effect on profit ?)
df1=df[['release_year','release_month','profit_val']].groupby(['release_year','release_month'])['profit_val'].sum()
df1
release_year  release_month
1960          1                5.079964e+07
              2                5.079964e+07
              3                5.079964e+07
              4                2.539982e+07
              5                5.079964e+07
              6                7.252964e+07
              7                3.519982e+07
              8                1.066425e+08
              9                2.536982e+07
              10               1.271045e+08
              12               6.089964e+07
1961          1                2.840795e+08
              3                2.369982e+07
              4                2.290000e+07
              5                2.389982e+07
              6                7.619946e+07
              7                2.539982e+07
              8                1.800000e+06
              9               -2.000000e+06
              10               1.303026e+08
              11               5.079964e+07
              12               1.116993e+08
1962          1                2.539982e+07
              2               -6.212600e+04
              3                1.250000e+06
              4                3.019982e+07
              5                2.000000e+06
              6                1.583989e+08
              7                5.124964e+07
              8                2.539982e+07
                                   ...     
2013          7                1.699954e+09
              8                1.441498e+09
              9                2.151680e+09
              10               2.184018e+09
              11               2.774297e+09
              12               2.390791e+09
2014          1                1.094545e+09
              2                1.291638e+09
              3                2.323372e+09
              4                1.718159e+09
              5                2.880055e+09
              6                2.201630e+09
              7                2.436532e+09
              8                2.137376e+09
              9                2.134642e+09
              10               2.928489e+09
              11               2.771809e+09
              12               2.547391e+09
2015          1                1.414610e+09
              2                1.484638e+09
              3                1.964202e+09
              4                3.390749e+09
              5                1.581898e+09
              6                4.506295e+09
              7                2.271935e+09
              8                1.660492e+09
              9                2.678119e+09
              10               2.016241e+09
              11               1.744371e+09
              12               3.545487e+09
Name: profit_val, Length: 660, dtype: float64
df2=df1.loc[df1.groupby(level=0).idxmax()]
df2
release_year  release_month
1960          10               1.271045e+08
1961          1                2.840795e+08
1962          6                1.583989e+08
1963          6                2.044338e+08
1964          10               2.327988e+08
1965          12               3.549167e+08
1966          6                1.786356e+08
1967          12               2.372984e+08
1968          10               1.159963e+08
1969          12               2.487732e+08
1970          12               3.040341e+08
1971          12               1.904166e+08
1972          3                2.916541e+08
1973          12               7.973017e+08
1974          12               3.827876e+08
1975          6                5.930533e+08
1976          12               3.727476e+08
1977          3                8.969873e+08
1978          7                4.824927e+08
1979          6                4.552818e+08
1980          1                5.624476e+08
1981          6                7.265409e+08
1982          4                9.565418e+08
1983          5                6.027028e+08
1984          6                6.667141e+08
1985          7                4.978334e+08
1986          9                4.302634e+08
1987          6                6.488053e+08
1988          12               8.849303e+08
1989          6                1.118679e+09
1990          11               1.066050e+09
1991          7                8.482817e+08
1992          11               1.414292e+09
1993          6                1.442112e+09
1994          7                1.447580e+09
1995          7                1.730071e+09
1996          6                1.303018e+09
1997          11               2.256101e+09
1998          7                1.671289e+09
1999          5                1.540885e+09
2000          12               1.421887e+09
2001          12               1.906008e+09
2002          12               2.095215e+09
2003          5                2.362661e+09
2004          5                2.643527e+09
2005          5                1.830070e+09
2006          6                2.630459e+09
2007          6                3.157814e+09
2008          6                2.369763e+09
2009          12               3.858926e+09
2010          6                2.697655e+09
2011          7                2.722978e+09
2012          11               3.398584e+09
2013          6                3.069834e+09
2014          10               2.928489e+09
2015          6                4.506295e+09
Name: profit_val, dtype: float64
df3=df2.groupby('release_month').count()
df3.plot(kind='bar')
plt.title("Number of movies released in months")
​
Text(0.5,1,'Number of movies released in months')

df4=df2.groupby('release_month').sum()
df4.plot(kind='bar')
plt.title("Profits of movies released in months")
​
Text(0.5,1,'Profits of movies released in months')

It seems that most number of movies were in june & December with little difference but interms of profits total profits in june is far from any othere month


Conclusions
It is clear from Visual that high popularity have its poistive effect on profit which confirm marketing for movie could play important role in getting high profits.
High Budget for movie play important role for gih revenue expectations.
As we mentioned popluraity is more important for profits compared to Voting which mean that making good movie is less important than how you market it.
No big effect for movie duration on our indicators so it could be neglected.
In general Profits comes more from dynamic movies(Action&Adventure) followed by comedian movies.
Vote average for documentry Movies are the highes all time.
It is preferred to lunch movies in june as there is a good indicator for profits in this month.
Limitations
There was big number of NAN Values which may lead to wrong analysis so I dropped it.

zero vaues in revenues and budget was too huge to be removed so I replaced them with mean value of each of thier columns.

Some columns will not be used in my anallysis so instead of keeping them as visual noise source i removed them.

to be able to answer questions related to dates i needed to conver relaese date to datetime format.

Casr columns was complicated to be used in its default for analysis so i split first value although it is not 100% accurate but it could be used as an indicator.

from subprocess import call
call(['python', '-m', 'nbconvert', 'Investigate_a_Dataset.ipynb'])
0
​
